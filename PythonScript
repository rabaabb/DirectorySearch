{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 91,
   "metadata": {},
   "outputs": [],
   "source": [
    "import csv\n",
    "import copy \n",
    "import matplotlib\n",
    "import pandas as pd\n",
    "from collections import OrderedDict\n",
    "import sys\n",
    "from pandas import DataFrame\n",
    "import csv"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 92,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>FullName</th>\n",
       "      <th>FirstName</th>\n",
       "      <th>LastName</th>\n",
       "      <th>AddressLine1</th>\n",
       "      <th>Age</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>Hector J Zuniga</td>\n",
       "      <td>Hector</td>\n",
       "      <td>Zuniga</td>\n",
       "      <td>10 Greystone Ct</td>\n",
       "      <td>63</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>Hector Zuniga</td>\n",
       "      <td>Hector</td>\n",
       "      <td>Zuniga</td>\n",
       "      <td>10 Greystone Ct</td>\n",
       "      <td>0\"</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>Laurie Ann Zuniga</td>\n",
       "      <td>Laurie</td>\n",
       "      <td>Zuniga</td>\n",
       "      <td>10 Greystone Ct</td>\n",
       "      <td>60</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>Laurie Zuniga</td>\n",
       "      <td>Laurie</td>\n",
       "      <td>Zuniga</td>\n",
       "      <td>10 Greystone Ct</td>\n",
       "      <td>0\"</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>Mariana L Zuniga</td>\n",
       "      <td>Mariana</td>\n",
       "      <td>Zuniga</td>\n",
       "      <td>335 Reflections Cir</td>\n",
       "      <td>0\"</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>866</th>\n",
       "      <td>5</td>\n",
       "      <td>Rajeev Tiwari</td>\n",
       "      <td>Rajeev</td>\n",
       "      <td>Tiwari</td>\n",
       "      <td>60 Springhaven Ct</td>\n",
       "      <td>0\"</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>867</th>\n",
       "      <td>0</td>\n",
       "      <td>Matthew R Tirrell</td>\n",
       "      <td>Matthew</td>\n",
       "      <td>Tirrell</td>\n",
       "      <td>1310 Bollinger Crest Cmn</td>\n",
       "      <td>49</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>868</th>\n",
       "      <td>1</td>\n",
       "      <td>Matthew Tirrell</td>\n",
       "      <td>Matthew</td>\n",
       "      <td>Tirrell</td>\n",
       "      <td>1310 Bollinger Crest Cmn</td>\n",
       "      <td>0\"</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>869</th>\n",
       "      <td>2</td>\n",
       "      <td>Melanie A Tirrell</td>\n",
       "      <td>Melanie</td>\n",
       "      <td>Tirrell</td>\n",
       "      <td>311 Alora Ct</td>\n",
       "      <td>49</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>870</th>\n",
       "      <td>3</td>\n",
       "      <td>Melanie Tirrell</td>\n",
       "      <td>Melanie</td>\n",
       "      <td>Tirrell</td>\n",
       "      <td>311 Alora Ct</td>\n",
       "      <td>0\"</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>871 rows Ã— 6 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     Unnamed: 0           FullName FirstName LastName  \\\n",
       "0             0    Hector J Zuniga    Hector   Zuniga   \n",
       "1             1      Hector Zuniga    Hector   Zuniga   \n",
       "2             2  Laurie Ann Zuniga    Laurie   Zuniga   \n",
       "3             3      Laurie Zuniga    Laurie   Zuniga   \n",
       "4             4   Mariana L Zuniga   Mariana   Zuniga   \n",
       "..          ...                ...       ...      ...   \n",
       "866           5      Rajeev Tiwari    Rajeev   Tiwari   \n",
       "867           0  Matthew R Tirrell   Matthew  Tirrell   \n",
       "868           1    Matthew Tirrell   Matthew  Tirrell   \n",
       "869           2  Melanie A Tirrell   Melanie  Tirrell   \n",
       "870           3    Melanie Tirrell   Melanie  Tirrell   \n",
       "\n",
       "                 AddressLine1 Age  \n",
       "0             10 Greystone Ct  63  \n",
       "1             10 Greystone Ct  0\"  \n",
       "2             10 Greystone Ct  60  \n",
       "3             10 Greystone Ct  0\"  \n",
       "4         335 Reflections Cir  0\"  \n",
       "..                        ...  ..  \n",
       "866         60 Springhaven Ct  0\"  \n",
       "867  1310 Bollinger Crest Cmn  49  \n",
       "868  1310 Bollinger Crest Cmn  0\"  \n",
       "869              311 Alora Ct  49  \n",
       "870              311 Alora Ct  0\"  \n",
       "\n",
       "[871 rows x 6 columns]"
      ]
     },
     "execution_count": 92,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Step 1\n",
    "#takes csv file from maxPrep or YB data - from Melissa Code\n",
    "data = pd.read_csv(\"/Users/aishvishah/Documents/brightfox/CalMelissa/CalExcel2025-12.csv\")\n",
    "data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 93,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>FullName</th>\n",
       "      <th>FirstName</th>\n",
       "      <th>LastName</th>\n",
       "      <th>AddressLine1</th>\n",
       "      <th>Age</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Hector J Zuniga</td>\n",
       "      <td>Hector</td>\n",
       "      <td>Zuniga</td>\n",
       "      <td>10 Greystone Ct</td>\n",
       "      <td>63</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Hector Zuniga</td>\n",
       "      <td>Hector</td>\n",
       "      <td>Zuniga</td>\n",
       "      <td>10 Greystone Ct</td>\n",
       "      <td>0\"</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Laurie Ann Zuniga</td>\n",
       "      <td>Laurie</td>\n",
       "      <td>Zuniga</td>\n",
       "      <td>10 Greystone Ct</td>\n",
       "      <td>60</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Laurie Zuniga</td>\n",
       "      <td>Laurie</td>\n",
       "      <td>Zuniga</td>\n",
       "      <td>10 Greystone Ct</td>\n",
       "      <td>0\"</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Mariana L Zuniga</td>\n",
       "      <td>Mariana</td>\n",
       "      <td>Zuniga</td>\n",
       "      <td>335 Reflections Cir</td>\n",
       "      <td>0\"</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>866</th>\n",
       "      <td>Rajeev Tiwari</td>\n",
       "      <td>Rajeev</td>\n",
       "      <td>Tiwari</td>\n",
       "      <td>60 Springhaven Ct</td>\n",
       "      <td>0\"</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>867</th>\n",
       "      <td>Matthew R Tirrell</td>\n",
       "      <td>Matthew</td>\n",
       "      <td>Tirrell</td>\n",
       "      <td>1310 Bollinger Crest Cmn</td>\n",
       "      <td>49</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>868</th>\n",
       "      <td>Matthew Tirrell</td>\n",
       "      <td>Matthew</td>\n",
       "      <td>Tirrell</td>\n",
       "      <td>1310 Bollinger Crest Cmn</td>\n",
       "      <td>0\"</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>869</th>\n",
       "      <td>Melanie A Tirrell</td>\n",
       "      <td>Melanie</td>\n",
       "      <td>Tirrell</td>\n",
       "      <td>311 Alora Ct</td>\n",
       "      <td>49</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>870</th>\n",
       "      <td>Melanie Tirrell</td>\n",
       "      <td>Melanie</td>\n",
       "      <td>Tirrell</td>\n",
       "      <td>311 Alora Ct</td>\n",
       "      <td>0\"</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>871 rows Ã— 5 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "              FullName FirstName LastName              AddressLine1 Age\n",
       "0      Hector J Zuniga    Hector   Zuniga           10 Greystone Ct  63\n",
       "1        Hector Zuniga    Hector   Zuniga           10 Greystone Ct  0\"\n",
       "2    Laurie Ann Zuniga    Laurie   Zuniga           10 Greystone Ct  60\n",
       "3        Laurie Zuniga    Laurie   Zuniga           10 Greystone Ct  0\"\n",
       "4     Mariana L Zuniga   Mariana   Zuniga       335 Reflections Cir  0\"\n",
       "..                 ...       ...      ...                       ...  ..\n",
       "866      Rajeev Tiwari    Rajeev   Tiwari         60 Springhaven Ct  0\"\n",
       "867  Matthew R Tirrell   Matthew  Tirrell  1310 Bollinger Crest Cmn  49\n",
       "868    Matthew Tirrell   Matthew  Tirrell  1310 Bollinger Crest Cmn  0\"\n",
       "869  Melanie A Tirrell   Melanie  Tirrell              311 Alora Ct  49\n",
       "870    Melanie Tirrell   Melanie  Tirrell              311 Alora Ct  0\"\n",
       "\n",
       "[871 rows x 5 columns]"
      ]
     },
     "execution_count": 93,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data = data[[\"FullName\", \"FirstName\", \"LastName\", \"AddressLine1\", \"Age\"]]\n",
    "data.sort_values(by=['AddressLine1', 'LastName'])\n",
    "\n",
    "data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 94,
   "metadata": {},
   "outputs": [],
   "source": [
    "#delate all rows with \"PO Box\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 95,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Address</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>10 Greystone Ct</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>140 Woodcrest Dr</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>506 Estancia Ct</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>708 Ardleigh Ct</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>810 Winterside Cir</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>518 Caprio Ct</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>9563 Belle Meade Dr</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>10 Carousel Ct</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>65 Moore Ct</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>3024 Bernard Ave</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>1426 Promontory Ter</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>165 Valdivia Cir</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>152 Baltusrol Pl</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>2697 Derby Dr</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>110 Sunnybrook Pl</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>2724 Sherbear Dr</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>2525 Twin Creeks Dr</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>3366 Loreto Dr</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>PO Box 3885</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>9767 Davona Dr</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>25 Saba Ct</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>64 Moore Ct</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>2631 Celaya Cir</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>3309 El Suyo Dr</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>421 Barranca Ct</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>PO Box 3594</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>2865 Sombrero Cir</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>3243 Ensenada Dr</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>93 Pioneer Ct</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>2822 Bowlin Ave</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>9611 Davona Dr</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>2431 Ascension Dr</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32</th>\n",
       "      <td>168 Arvada Ct</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>33</th>\n",
       "      <td>62 Hazelnut Ct</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>34</th>\n",
       "      <td>2832 Saint Denis Dr</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>35</th>\n",
       "      <td>216 Triana Way</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>36</th>\n",
       "      <td>4071 Dunbarton Cir</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37</th>\n",
       "      <td>PO Box 2721</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38</th>\n",
       "      <td>3000 Kittery Ave</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>39</th>\n",
       "      <td>3718 Canyon Village Cir</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>40</th>\n",
       "      <td>2540 Toltec Cir</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>41</th>\n",
       "      <td>2465 Camino De Jugar</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42</th>\n",
       "      <td>5052 Westside Dr</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>43</th>\n",
       "      <td>9829 Del Mar Dr</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44</th>\n",
       "      <td>7410 Sedgefield Ave</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>45</th>\n",
       "      <td>2572 Toltec Cir</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46</th>\n",
       "      <td>3061 Ascot Dr</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>47</th>\n",
       "      <td>36 Terraced Hills Cir</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>48</th>\n",
       "      <td>3195 Pine Valley Rd</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49</th>\n",
       "      <td>3336 Estero Dr</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50</th>\n",
       "      <td>670 Greylyn Dr</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>51</th>\n",
       "      <td>124 Marsh Pl</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                    Address\n",
       "0           10 Greystone Ct\n",
       "1          140 Woodcrest Dr\n",
       "2           506 Estancia Ct\n",
       "3           708 Ardleigh Ct\n",
       "4        810 Winterside Cir\n",
       "5             518 Caprio Ct\n",
       "6       9563 Belle Meade Dr\n",
       "7            10 Carousel Ct\n",
       "8               65 Moore Ct\n",
       "9          3024 Bernard Ave\n",
       "10      1426 Promontory Ter\n",
       "11         165 Valdivia Cir\n",
       "12         152 Baltusrol Pl\n",
       "13            2697 Derby Dr\n",
       "14        110 Sunnybrook Pl\n",
       "15         2724 Sherbear Dr\n",
       "16      2525 Twin Creeks Dr\n",
       "17           3366 Loreto Dr\n",
       "18              PO Box 3885\n",
       "19           9767 Davona Dr\n",
       "20               25 Saba Ct\n",
       "21              64 Moore Ct\n",
       "22          2631 Celaya Cir\n",
       "23          3309 El Suyo Dr\n",
       "24          421 Barranca Ct\n",
       "25              PO Box 3594\n",
       "26        2865 Sombrero Cir\n",
       "27         3243 Ensenada Dr\n",
       "28            93 Pioneer Ct\n",
       "29          2822 Bowlin Ave\n",
       "30           9611 Davona Dr\n",
       "31        2431 Ascension Dr\n",
       "32            168 Arvada Ct\n",
       "33           62 Hazelnut Ct\n",
       "34      2832 Saint Denis Dr\n",
       "35           216 Triana Way\n",
       "36       4071 Dunbarton Cir\n",
       "37              PO Box 2721\n",
       "38         3000 Kittery Ave\n",
       "39  3718 Canyon Village Cir\n",
       "40          2540 Toltec Cir\n",
       "41     2465 Camino De Jugar\n",
       "42         5052 Westside Dr\n",
       "43          9829 Del Mar Dr\n",
       "44      7410 Sedgefield Ave\n",
       "45          2572 Toltec Cir\n",
       "46            3061 Ascot Dr\n",
       "47    36 Terraced Hills Cir\n",
       "48      3195 Pine Valley Rd\n",
       "49           3336 Estero Dr\n",
       "50           670 Greylyn Dr\n",
       "51             124 Marsh Pl"
      ]
     },
     "execution_count": 95,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#initialize exit \n",
    "exit = False\n",
    "#initialize list to store valid addresses \n",
    "addresses = []\n",
    "#initialize address\n",
    "address = data.iloc[0][3]\n",
    "# initialize count tracker\n",
    "count = 0\n",
    "#initialize list that contains all first names\n",
    "first_names_list = [data.iloc[0][1]]\n",
    "#inditialze index \n",
    "index = 0\n",
    "#last name tracker \n",
    "last_name = [data.iloc[0][2]]\n",
    "#address counter - to find the unique addresses \n",
    "address_counter = 0\n",
    "#list to save unqiue addresses \n",
    "\n",
    "while index < len(data)-1:\n",
    "\n",
    "    #skips any Nan - empty data\n",
    "    if data.iloc[index][0] is None or data.iloc[index][1] is None or data.iloc[index][2] is None:\n",
    "        index += 1\n",
    "\n",
    "    #while loop that checks to see if the adress is the same \n",
    "    while data.iloc[index][3] == address:\n",
    "        if data.iloc[index][1] not in first_names_list and data.iloc[index][2] == last_name:\n",
    "            #increment counter of how many same adresses and last names \n",
    "            count += 1\n",
    "\n",
    "            #update first name everytime (new comparission)\n",
    "            first_names_list.append(data.iloc[index][1])\n",
    "            index += 1   \n",
    "             #only add addess to list if greater than 2 lists in house with same last name\n",
    "\n",
    "            if count >= 2 and address not in addresses:\n",
    "                addresses.append(address)\n",
    "            if index < len(data):\n",
    "                continue\n",
    "            #break out of while loop for entire data set complete \n",
    "            else:\n",
    "                exit = True\n",
    "                break\n",
    "    \n",
    "        else:\n",
    "            break\n",
    "    \n",
    "    #break out of second while loop once traversal complete \n",
    "    if exit == True:\n",
    "        break\n",
    "\n",
    "    #clear out first names list\n",
    "    first_names_list = []\n",
    "    #reset counter\n",
    "    count = 0\n",
    "    #set a new address\n",
    "    address = data.iloc[index][3]\n",
    "    #last name\n",
    "    last_name = data.iloc[index][2]\n",
    "    \n",
    "    \n",
    "addresses\n",
    "\n",
    "\n",
    "#convert the list to a csv \n",
    "df = DataFrame(addresses,columns=['Address'])\n",
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 96,
   "metadata": {},
   "outputs": [],
   "source": [
    "#change to your csv file \n",
    "df.to_csv(r'/Users/aishvishah/Documents/brightfox/Addresses- Cal/2025/addresses_cal12.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
